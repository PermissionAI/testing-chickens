<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project Hell Yeah - Brand Portal</title>
  <link rel="stylesheet" href="https://cdn.prod.website-files.com/67c771c6f7894b7707a8c19d/css/permission-io.shared.c64c7fab2.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body class="container-medium text-align-center">
  <h1>Permission Brand Portal</h1>
  <div id="brandChat" class="container-medium">
    <div id="brandLog"></div>
    <input type="text" id="brandInput" placeholder="Type here...">
    <button id="brandSend" class="button">Send</button>
  </div>
  <div id="wizard" class="hidden container-medium">
    <div id="step1" class="step">
      <h2>Define Audience</h2>
      <textarea id="audienceInput" rows="3">New parents. Ideally household income over 100k. First-time families.</textarea><br>
      <button id="step1Next" class="button">Next</button>
    </div>
    <div id="step2" class="step hidden">
      <h2>Generate Creative & Copy</h2>
      <p><strong>Headline:</strong> <span id="adHeadline"></span></p>
      <p><strong>Body:</strong> <span id="adCopy"></span></p>
      <button id="step2Next" class="button">Next</button>
    </div>
    <div id="step3" class="step hidden">
      <h2>Preview Ad</h2>
      <div class="tile card">
        <h3 id="previewHeadline"></h3>
        <p id="previewBody"></p>
      </div>
      <button id="launchBtn" class="button">Launch Campaign</button>
    </div>
  </div>
  <div id="summary" class="hidden container-medium"></div>
  <script>
  const params = new URLSearchParams(window.location.search);
  const demo = params.get('demo');

  const log = document.getElementById('brandLog');
  const input = document.getElementById('brandInput');
  const send = document.getElementById('brandSend');
  const wizard = document.getElementById('wizard');
  const step1Next = document.getElementById('step1Next');
  const step2Next = document.getElementById('step2Next');
  const launchBtn = document.getElementById('launchBtn');
  const audienceInput = document.getElementById('audienceInput');
  const adHeadlineEl = document.getElementById('adHeadline');
  const adCopyEl = document.getElementById('adCopy');
  const previewHeadline = document.getElementById('previewHeadline');
  const previewBody = document.getElementById('previewBody');
  const summary = document.getElementById('summary');

  const brandNames = ['Bambino Diapers','Happy Tush','SnugBug','EcoBaby','SoftCare'];
  const brand = brandNames[Math.floor(Math.random()*brandNames.length)];
  let bstep = 0;
  let awaitingOffer = false;
  const script = [
    'Welcome back. Who are you hoping to connect with today?',
    "Got it. Let\u2019s build your audience. We\u2019ll use Google targeting + Permission signals. Want to include your CRM list?"
  ];

  function append(m, cls){
    const p = document.createElement('p');
    p.textContent = m;
    if(cls) p.className = cls;
    log.appendChild(p);
    log.scrollTop = log.scrollHeight;
  }

  function showWizard(){
    wizard.classList.remove('hidden');
  }

  function next(){
    if(bstep < script.length){
      append(script[bstep], 'ai');
      bstep++;
      if(bstep === script.length){
        showWizard();
      }
    }
  }

  send.onclick = () => {
    const val = input.value.trim();
    if(!val) return;
    append(val, 'user');
    input.value='';
    if(awaitingOffer){
      showOfferSummary(val);
      awaitingOffer = false;
    } else {
      next();
    }
  };

  function generateCreative(){
    const head = 'Welcome New Parents!';
    const body = 'Save on essentials for your growing family with ' + brand + '.';
    adHeadlineEl.textContent = head;
    adCopyEl.textContent = body;
    previewHeadline.textContent = head;
    previewBody.textContent = body;
  }

  step1Next.onclick = () => {
    document.getElementById('step1').classList.add('hidden');
    generateCreative();
    document.getElementById('step2').classList.remove('hidden');
  };

  step2Next.onclick = () => {
    document.getElementById('step2').classList.add('hidden');
    document.getElementById('step3').classList.remove('hidden');
  };

  launchBtn.onclick = () => {
    document.getElementById('step3').classList.add('hidden');
    wizard.classList.add('hidden');
    append('Want to reach families already on Permission too? You can offer them a reward to join you.', 'ai');
    awaitingOffer = true;
  };

  function showOfferSummary(txt){
    summary.innerHTML = '<p>' + txt + '</p>';
    const go = document.createElement('button');
    go.className = 'button';
    go.textContent = 'Go Live';
    go.onclick = () => {
      const offers = JSON.parse(localStorage.getItem('offers') || '[]');
      offers.push({brand: brand, reward: txt});
      localStorage.setItem('offers', JSON.stringify(offers));
      summary.innerHTML = '<p>Campaign live!</p>';
      const nextBtn = document.createElement('button');
      nextBtn.className = 'button';
      nextBtn.textContent = 'Next';
      nextBtn.onclick = () => {
        const url = demo ? 'index.html?demo=1&scene=final' : 'index.html?scene=final';
        window.location.href = url;
      };
      summary.appendChild(nextBtn);
    };
    summary.appendChild(go);
    summary.classList.remove('hidden');
  }

  function guidedDemo(){
    const msgs = ['New parents. Ideally household income over 100k. First-time families.', 'Yes â€” let\u2019s offer 800 ASK + $5 off.'];
    let i = 0;
    input.value = msgs[i];
    send.onclick = () => {
      const val = input.value.trim();
      if(!val) return;
      append(val, 'user');
      input.value='';
      if(awaitingOffer){
        showOfferSummary(val);
        awaitingOffer = false;
      } else {
        next();
        if(i === 0){
          setTimeout(() => step1Next.click(), 300);
          setTimeout(() => step2Next.click(), 600);
          setTimeout(() => launchBtn.click(), 900);
        }
      }
      i++;
      if(i < msgs.length){
        setTimeout(() => { input.value = msgs[i]; }, 100);
      }
    };
  }

  window.onload = () => {
    next();
    if(demo){
      setTimeout(guidedDemo, 500);
    }
  };
  </script>
</body>
</html>
